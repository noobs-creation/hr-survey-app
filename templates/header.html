<style>
    /* 1. Transitions for smooth switching */
    body, .container, .user-card, .kpi-card, .ai-section, table, th, td {
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    }

    /* 2. Dark Mode Definitions */
    body.dark-mode {
        background-color: #121212 !important; /* Deep Black/Grey */
        color: #e0e0e0 !important;
    }

    /* Containers and Cards */
    body.dark-mode .container, 
    body.dark-mode .user-card, 
    body.dark-mode .kpi-card, 
    body.dark-mode .card-details,
    body.dark-mode .chart-section > div, /* For Report Page boxes */
    body.dark-mode .rating-scale-box /* For Survey Page */
    {
        background-color: #1e1e1e !important; /* Dark Grey Cards */
        border-color: #333 !important;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3) !important;
        color: #e0e0e0 !important;
    }

    /* Headings */
    body.dark-mode h1, 
    body.dark-mode h2, 
    body.dark-mode h3, 
    body.dark-mode h4,
    body.dark-mode strong {
        color: #fff !important;
    }
    
    /* Specific Orange Accents for Dark Mode */
    body.dark-mode h1 {
        color: #FF8533 !important; /* Lighter Orange for readability */
    }

    /* Tables */
    body.dark-mode .data-table th {
        background-color: #2c2c2c !important;
        color: #ccc !important;
        border-bottom: 1px solid #444 !important;
    }
    body.dark-mode .data-table td {
        border-bottom: 1px solid #333 !important;
        color: #ccc !important;
    }
    body.dark-mode .cat-tag {
        background-color: #333 !important;
        color: #eee !important;
    }

    /* AI Section */
    body.dark-mode .ai-section {
        background-color: #1a202c !important; /* Dark Blue-Grey */
        border-color: #2d3748 !important;
    }
    body.dark-mode .ai-header {
        border-bottom-color: #2d3748 !important;
    }
    body.dark-mode .ai-content {
        color: #ccc !important;
    }
    
    /* Subtitles and Meta text */
    body.dark-mode .subtitle, 
    body.dark-mode .user-meta, 
    body.dark-mode .stat-label {
        color: #999 !important;
    }

    /* Inputs for Survey Page */
    body.dark-mode input[type="text"], 
    body.dark-mode input[type="number"], 
    body.dark-mode select {
        background-color: #2c2c2c;
        border: 1px solid #444;
        color: white;
    }

    /* --- TOGGLE BUTTON STYLING --- */
    .theme-toggle-btn {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
        margin-left: auto; /* Pushes button to the right */
        color: white;
    }
    .theme-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.4);
        transform: scale(1.05);
    }
    .theme-toggle-btn i {
        font-size: 1.2em;
    }
</style>

<header style="background: linear-gradient(135deg, #FF6600 0%, #E65C00 100%); padding: 15px 40px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 30px; display: flex; align-items: center; gap: 20px;">
    
    <div style="background: white; padding: 10px; border-radius: 8px; display: flex; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <img src="{{ url_for('static', filename='Bstl logo orange.png') }}" alt="BSTL Logo" style="height: 65px; width: auto;">
    </div>
    
    <div style="color: white; font-family: 'Segoe UI', sans-serif;">
        <h2 style="margin: 0; font-size: 1.6em; font-weight: 600; letter-spacing: 0.5px;">BarodaSun Technologies Ltd</h2>
        <span style="font-size: 0.9em; opacity: 0.9;">HR Survey Portal</span>
    </div>

    <button class="theme-toggle-btn" onclick="toggleTheme()" title="Toggle Dark Mode">
        <i id="theme-icon" class="ph ph-moon"></i>
    </button>

</header>

<script>
    function toggleTheme() {
        const body = document.body;
        const icon = document.getElementById('theme-icon');
        
        // Toggle Class
        body.classList.toggle('dark-mode');
        
        // Toggle Icon (Moon to Sun)
        if (body.classList.contains('dark-mode')) {
            icon.classList.replace('ph-moon', 'ph-sun');
        } else {
            icon.classList.replace('ph-sun', 'ph-moon');
        }
        
        // Optional: Update Chart.js colors if charts exist on the page
        if (typeof Chart !== 'undefined') {
            Chart.defaults.color = body.classList.contains('dark-mode') ? '#ccc' : '#666';
            Chart.defaults.borderColor = body.classList.contains('dark-mode') ? '#444' : '#ddd';
            
            // Loop through all charts and update
            Chart.instances.forEach(chart => {
                chart.update();
            });
        }
    }
</script>
